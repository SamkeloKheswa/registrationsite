<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard - Hammarsdale Got Talent</title>
<style>
  body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f4f4f4; margin: 0; padding: 20px; }
  h1 { text-align: center; color: #ff6600; font-family: 'Georgia', serif; margin-bottom: 20px; }
  #search { width: 100%; padding: 10px; margin-bottom: 20px; border-radius: 5px; border: 1px solid #ccc; font-family: 'Trebuchet MS', sans-serif; }
  table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
  th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; font-family: 'Verdana', sans-serif; }
  th { background-color: #ff6600; color: white; }
  tr:hover { background-color: #f1f1f1; }
</style>
</head>
<body>

<h1>Admin Dashboard - Hammarsdale Got Talent</h1>

<input type="text" id="search" placeholder="Search by Name or Category...">

<table id="submissionsTable">
  <thead>
    <tr>
      <th>Full Name</th>
      <th>Email</th>
      <th>Phone</th>
      <th>Category</th>
      <th>Talent Category</th>
      <th>Talent Description</th>
    </tr>
  </thead>
  <tbody>
    <!-- Submissions will be populated here -->
  </tbody>
</table>

<script>
// Fetch submissions from Netlify function
async function fetchSubmissions() {
  try {
    const res = await fetch("/.netlify/functions/get-submissions");
    const data = await res.json();

    const tbody = document.querySelector("#submissionsTable tbody");
    tbody.innerHTML = "";

    if(data.length === 0) {
      tbody.innerHTML = "<tr><td colspan='6' style='text-align:center;'>No submissions yet</td></tr>";
      return;
    }

    data.forEach(entry => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${entry.data.fullname || ""}</td>
        <td>${entry.data.email || ""}</td>
        <td>${entry.data.phone || ""}</td>
        <td>${entry.data.category || ""}</td>
        <td>${entry.data.talentCategory || ""}</td>
        <td>${entry.data.talent || ""}</td>
      `;
      tbody.appendChild(row);
    });
  } catch(err) {
    console.error("Error fetching submissions:", err);
    document.querySelector("#submissionsTable tbody").innerHTML = "<tr><td colspan='6' style='text-align:center;'>Error loading submissions</td></tr>";
  }
}

// Simple search/filter function
document.getElementById("search").addEventListener("input", function() {
  const filter = this.value.toLowerCase();
  const rows = document.querySelectorAll("#submissionsTable tbody tr");
  rows.forEach(row => {
    const name = row.cells[0].textContent.toLowerCase();
    const category = row.cells[3].textContent.toLowerCase();
    if(name.includes(filter) || category.includes(filter)) {
      row.style.display = "";
    } else {
      row.style.display = "none";
    }
  });
});

// Initial fetch
fetchSubmissions();
</script>

</body>
</html>
